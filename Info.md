# ODS Migration Demo

####Jobstream Name

TODWSTPT

####JobNames

1. CMN_Ext_ChngTmstmp_Mosaic.TOD_LdLUS_WORK_CNTRL_PART_MNTNC_EST
2. TOD_LdLUS_WORK_CNTRL_PART_MNTNC_EST
3. TOD_UpsLUS_WORK_CNTRL_PART_MNTNC_EST



#### Job 1 Migration (Low Complexity)
SELECT cast(coalesce(cast(MAX(ROW_UPDT_TMS) as varchar(26)), '1900-01-01 00:00:00.000') as varchar(26)) AS LAST_UPDATE_TMS 
FROM #jpTD_MOSAIC_DB#.#jpTable_Nm#;

#### Job 2 (Medium Complexity)

Select 
WC_NUMBER,
SERIAL_NUMBER,
ME_PART_NUMBER,
KEY_TYPE,
TASK_CARD_NUMBER,
NUM_MECHANICS_REQUIRED,
GROUND_TIME_HOURS,
LABOR_HOURS,
INSPECTOR_HOURS,
SHOP_HOURS,
SKILL_TYPE,
AD_IND,
HANGAR_BAY_IND,
NOTICE_IND,
SPEC_TOOLING_IND,
DAILY_INSPECTION_IND,
PLANNING_PRIORITY,
PRIORITY_LOCK_IND,
MOCA_LAMPS_IND,
WORK_REQUIREMENT,
STATION_REQUIREMENTS,
REVISION_DATE,
WORK_NUMBER,
OPERATION_STEP,
TASK_TYPE,
MAINT_TYPE,
COMMENTS,
SCHEDULING_STATUS,
ISSUE_DATE,
REF_DOC,
BID_HOURS,
COMPLETION_HOURS,
CRITICAL_TASK_IND,
SIGNIFICANT_ITEM_IND,
CREATE_DATE,
CREATE_USER,
UPDATE_DATE,
UPDATE_USER
from #jpYOW_DB#.WC_STANDARDS_TEMPLATE_PART
WHERE COALESCE(TO_TIMESTAMP(substr(UPDATE_DATE,1,14),'yyyy-mm-dd hh24:mi:SS'),
TO_TIMESTAMP('1900-01-01 00:00:01.000000','yyyy-mm-dd hh24:mi:SS.FF')) >TO_TIMESTAMP('#CMN_EXT_CHNG_TMPSTMP.Extract_From_Tmstp#','yyyy-mm-dd hh24:mi:SS.FF');


Changes required-
Metadata columns are mapped differently
